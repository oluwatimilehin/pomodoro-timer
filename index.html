<!DOCTYPE html>
<html lang="en">

<head>
    <title>Pomodoro Timer</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
</head>

<body>
    <div class="container">
        <div class="mode">
            <h3 class="has-border" id="work"><a href="#" title="This sets the timer to 25 minutes">Work </a> </h3>
            <h3 class="has-border" id="break"> <a href="#" title="This sets the timer to 5 minutes."> Break </a> </h3>
        </div>
        <div class="timer-container">
            <div class="timer">
                <h2 class="work" id="mode">Work</h2>
                <div class="time-settings">
                    <p id="plus" class="arithmetic-controls"><a href="#">+</a></p>
                    <p class="time"> <span id="minutes">00</span> : <span id="seconds">05</span></p>
                    <p id="minus" class="arithmetic-controls"><a href="#">- </a></p>
                </div>
            </div>
        </div>
        <div class="timer-control">
            <h3 class="has-border" id="start"> <a href="#">Start </a> </h3>
            <h3 class="has-border" id="reset"><a href="#">Reset </a> </h3>
        </div>
    </div>
    <audio src="http://www.orangefreesounds.com/wp-content/uploads/2015/04/Loud-alarm-clock-sound.mp3" id="alarm" preload="auto">
    </audio>
    <script>
        var audio = document.getElementById('alarm');
        var interval;
        var controls = {
            modeSetting: document.getElementById('mode'),
            minutes: document.getElementById('minutes'),
            seconds: document.getElementById('seconds'),
            currentMinutes: parseInt(this.minutes.textContent),
            currentSeconds: parseInt(this.seconds.textContent),
            setToWorkMode: function () {
                this.minutes.textContent = "25";
                this.seconds.textContent = "00";
                this.modeSetting.textContent = "Work";
            },
            setToBreakMode: function () {
                this.minutes.textContent = "05";
                this.seconds.textContent = "00";
                this.modeSetting.textContent = "Break";
            },
            increaseTime: function () {
                this.currentSeconds += 30;
                if (this.currentSeconds === 30) {
                    this.seconds.textContent = this.currentSeconds;
                }
                else {
                    this.seconds.textContent = "00";
                    this.currentMinutes++;
                    this.minutes.textContent = this.currentMinutes;
                    if (this.minutes.textContent < 10) {
                        this.minutes.textContent = "0" + this.minutes.textContent;
                    }
                    this.currentSeconds = 0;
                }
            },
            decreaseTime: function () {
                this.currentSeconds -= 30;
                if (this.seconds.textContent === "00" && (this.minutes.textContent === "0" || this.minutes.textContent === "00")) {
                    return;
                }
                if (this.currentSeconds === 0) {
                    this.seconds.textContent = "00";
                }
                else {
                    this.seconds.textContent = "30";
                    this.currentSeconds = 30;
                    this.currentMinutes--;
                    this.minutes.textContent = this.currentMinutes;
                    if (this.minutes.textContent < 10) {
                        this.minutes.textContent = "0" + this.minutes.textContent;
                    }
                }
            },
            startTimer: function () {
                interval = setInterval(reduceSeconds, 1000);
                function reduceSeconds() {
                    if (this.seconds.textContent === "00" && (this.minutes.textContent === "0" || this.minutes.textContent === "00")) {
                        clearInterval(interval);
                        audio.play();
                        view.setUpEventListeners();
                    }
                    else {
                        if (this.seconds.textContent === "00") {
                            this.currentSeconds = 60;
                            this.currentSeconds--;
                            if (this.minutes.textContent <= 10) {
                                this.minutes.textContent--;
                                this.seconds.textContent;
                                this.minutes.textContent = "0" + this.minutes.textContent;
                            }
                            else {
                                this.minutes.textContent--;
                            }
                            this.seconds.textContent = this.currentSeconds;
                        }
                        else {
                            this.seconds.textContent--;
                            if (this.seconds.textContent === 0) {
                                this.seconds.textContent = "00";
                            }
                            else {
                                if (this.seconds.textContent < 10) {
                                    this.seconds.textContent = "0" + this.seconds.textContent;
                                }
                            }
                        }
                    }
                }
            },
            resetTimer: function () {
                this.setToWorkMode();
                clearInterval(interval);
                view.setUpEventListeners();
            }
        }
        var view = {
            setUpEventListeners: function () {
                var workButton = document.getElementById('work');
                var workMode = function () {
                    audio.pause();
                    controls.setToWorkMode();
                };
                workButton.addEventListener('click', workMode);


                var breakButton = document.getElementById('break');
                var breakMode = function () {
                    audio.pause();
                    controls.setToBreakMode();
                }
                breakButton.addEventListener('click', breakMode);

                var plusButton = document.getElementById('plus');
                var increaseTime = function () {
                    audio.pause();
                    controls.increaseTime();
                }
                plusButton.addEventListener('click', increaseTime);


                var minusButton = document.getElementById('minus');
                var decreaseTime = function () {
                    audio.pause();
                    controls.decreaseTime();
                };
                minusButton.addEventListener('click', decreaseTime);

                var startButton = document.getElementById('start');
                var clicked = 0;
                var startTimer = function () {
                    controls.startTimer();
                    clicked++;
                    workButton.removeEventListener('click', workMode);
                    breakButton.removeEventListener('click', breakMode);
                    plusButton.removeEventListener('click', increaseTime);
                    minusButton.removeEventListener('click', decreaseTime);
                    startButton.removeEventListener('click', startTimer);
                }
                startButton.addEventListener('click', startTimer);
                var resetButton = document.getElementById('reset');
                resetButton.addEventListener('click', function () {
                    audio.pause();
                    controls.resetTimer();
                })
            }
        }
        view.setUpEventListeners();
    </script>
</body>

</html>